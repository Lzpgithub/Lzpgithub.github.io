---
layout: post
title: 进程的创建
categories: 操作系统
description: 进程创建
keywords: C, 进程创建
---

#### 进程的创建

进程的创建方式有以下两种：

(1).由系统程序模块统一创建。

(2).由父进程创建，父进程创建子进程以完成并行工作。

由系统创建的进程之间的关系是平等，它们之间一般不存在资源继承关系。而在父进程创建的进程之间则存在隶属关系，且互相构成树型结构的家族关系，属于某个家族的一个进程可以继承其父进程所拥有的资源。

无论是系统创建方式还是父进程创建方式，都必须调用创建原语来实现。创建原语扫描系统PCB链表，在找到一定PCB表之后，填入调用者提供的有关参数，最后形成代表进程的PCB结构，这些参数包括：进程名、进程优先级P0、进程正文段起始地址d0、资源清单R0等。

![](/images/posts/OS/8.png)

#### 进程的撤销

进程撤销有三种情况：该进程已完成所要求的功能而正常终止；由于某种错误导致非正常终止；祖先进程要求撤销某个子进程。

进程被撤销时，进程都必须释放它所占用的各种资源和PCB结构本身，以利于资源的有效利用。当然，一个进程所占有的某些资源在使用结束时可能早已释放。

当一个祖先进程撤销某个子进程时，还需审查该子进程是否还有自己的子孙进程，若有的话，还需要撤销其子孙进程的PCB结构和释放它们所占有的资源。

撤销原语首先检查PCB进程链或者进程家族，寻找所要撤销的进程是否存在，如果找到了所要撤销的的进程PCB结构，则撤销原语释放该进程的所占有的资源之后，把对应的PCB结构从进程链或进程家族中摘下并返回给PCB空队列。如果被撤销进程有自己的子进程，则撤销原语先撤销其子进程的PCB结构并释放子进程所占有的资源之后，再撤销当前进程的PCB结构和释放其资源。

![](/images/posts/OS/9.png)

#### 进程的阻塞与唤醒

实现进程的执行状态到等待状态，又由等待状态到就绪状态的转换对应于两种原语：阻塞原语和唤醒原语。

阻塞原语在一个进程期待某一事件(例如键盘输入数据、写盘、其他进程发来的数据等)发生，但发生条件尚不具备时，该进程就调用阻塞原语来阻塞自己。阻塞原语在阻塞一个进程时，由于该进程正处于执行状态，因此先中断处理机和保存该进程的CPU现场，然后将被阻塞进程置阻塞状态后插入等待队列中，再通过转进程调度程序选择新的就绪进程投入运行。转进程调度程序是很重要的，否则，处理机将会出现空转而浪费资源。

![](/images/posts/OS/10.png)

当等待队列中的进程所等待的事件发生时，等待该事件的所有进程都将被唤醒。一个处于阻塞状态的进程不可能自己唤醒自己，唤醒一个进程有两种方法：首先是系统进程唤醒，系统进程统一控制事件的发生并将"事件发生"这一消息通知等待进程，从而使得该进程因等待事件已发生而进入就绪队列；另一个是事件发生进程唤醒，事件发生进程和被唤醒进程之间是合作关系。

唤醒原语既可被系统进程调用，也可以被事件发生进程调用，因此称调用唤醒原语的进程为唤醒进程。唤醒原语首先将被唤醒进程从相应的等待队列中摘下，将被唤醒进程设置为就绪状态之后，送入就绪队列。

![](/images/posts/OS/11.png)


