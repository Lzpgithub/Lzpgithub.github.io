---
layout: post
title: 进程的同步
categories: 操作系统
description: 进程的同步
keywords: C, 进程，同步
---

#### 进程同步引入例子

计算进程和打印进程共同使用同一缓冲区Buf，计算进程反复地把每次计算结果放入Buf中，而打印进程则把计算进程每次放入Buf中的数据通过打印机打印输出。如果不采取任何制约措施，这两个进程的执行起始时间和执行速度都是彼此独立的，其相应的控制段可以描述为：

![](/images/posts/OS/22.png)

假定进程Pc和Pp对公用缓冲区Buf已经采用了互斥措施。

显然，如果按照上面的描述并发执行进程Pc和Pp，则会造成造成CPU时间的极大浪费，因为其中包含有二处反复测试语句，这是操作系统所不允许的。CPU时间的浪费主要是由于进程Pc和Pp的执行相互制约所起的。Pc进程的输出结果是Pp执行的条件，反之，Pp的执行结果也是Pc的执行条件。这种现象在操作系统和用户进程中大量存在。与进程互斥不同的是，进程互斥时进程的执行顺序是可以随意的。


#### 进程同步概念

一组在异步环境下的并发进程，各自的执行结果互为对方的执行条件，从而限制个进程的执行速度的过程称为并发进程间的直接制约。

由以上的例子可知，如果没有相应的解决办法，进程的直接制约将会造成大量的CPU时间浪费。一种最为简单和直观的方法是直接制约的进程互相给对方进程发送执行条件已经具备的信号。这样，被制约的进程即可省去对执行条件的测试，只要收到制约进程发过来的信号便开始执行，而在未收到制约进程发过来的信号时便进入等待状态。

把异步环境下的一组并发进程，因直接制约而互相发送消息而进行互相合作、互相等待，使得各进程按一定的速度执行的过程称为进程间的同步。具有同步关系的一组并发进程称为合作进程，合作进程间相互发送的信号称为消息或事件。

表示进程等待合作进程发过来的消息：

wait(消息名)

表示向合作进程发送消息：

signal(消息名)

利用过程wait和signal，可以简单地描述上面例子中的计算进程Pc和打印进程Pb的同步关系如下：

1.设消息名Bufempty表示Buf为空，消息名Buffull表示Buf中装满了数据；

2.初始化Bufempty=true，Buffull=false；

3.描述：

![](/images/posts/OS/23.png)


过程wait的功能是等待到消息名为true的进程继续执行，而signal的功能是向合作进程发送所需要的消息名，并将其值置为true。





